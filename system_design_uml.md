# 系统架构设计与UML建模文档

## 一、系统整体架构图

### 1.1 部署架构图

```
                    Internet
                        |
              ┌─────────────────┐
              │   Load Balancer │
              │     (Nginx)     │
              └─────────────────┘
                        |
            ┌───────────┼───────────┐
            │           │           │
    ┌───────────┐ ┌───────────┐ ┌───────────┐
    │   Web     │ │   Web     │ │   Web     │
    │ Server 1  │ │ Server 2  │ │ Server 3  │
    └───────────┘ └───────────┘ └───────────┘
            │           │           │
            └───────────┼───────────┘
                        |
              ┌─────────────────┐
              │  Application    │
              │    Server       │
              │ (SpringBoot)    │
              └─────────────────┘
                        |
        ┌───────────────┼───────────────┐
        │               │               │
┌───────────┐   ┌───────────────┐   ┌───────────┐
│  MySQL    │   │    Redis      │   │   AI API  │
│ Database  │   │    Cache      │   │ (外部服务) │
└───────────┘   └───────────────┘   └───────────┘
```

### 1.2 技术架构图

```
┌─────────────────────────────────────────────────────────────────┐
│                        前端层 (Frontend)                        │
├─────────────────────────────────────────────────────────────────┤
│  Vue 3.2.45 + TypeScript 4.9.4 + Ant Design Vue 3.2.20      │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ │
│  │   用户界面   │ │   管理后台   │ │   移动端     │ │   API文档    │ │
│  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘ │
└─────────────────────────────────────────────────────────────────┘
                                │
                        HTTP/HTTPS RESTful API
                                │
┌─────────────────────────────────────────────────────────────────┐
│                        后端层 (Backend)                         │
├─────────────────────────────────────────────────────────────────┤
│            SpringBoot 2.5.5 + Java 1.8                       │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ │
│  │ Controller  │ │   Service   │ │ Repository  │ │    Utils    │ │
│  │   (API)     │ │  (业务逻辑)  │ │  (数据访问)  │ │   (工具类)   │ │
│  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘ │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ │
│  │ Interceptor │ │   Config    │ │   Entity    │ │   Exception │ │
│  │  (拦截器)    │ │   (配置)    │ │  (实体类)    │ │  (异常处理)  │ │
│  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘ │
└─────────────────────────────────────────────────────────────────┘
                                │
                        JDBC + MyBatis-Plus
                                │
┌─────────────────────────────────────────────────────────────────┐
│                        数据层 (Data)                           │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ │
│  │   MySQL     │ │    Redis    │ │ File System │ │  External   │ │
│  │  (主数据库)  │ │   (缓存)    │ │  (文件存储)  │ │ API (AI服务) │ │
│  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

## 二、系统用例图 (Use Case Diagram)

### 2.1 整体用例图

```
                    智能书城管理系统
┌─────────────────────────────────────────────────────────────────┐
│                                                                │
│  ┌──────────────┐              ┌─────────────────────────────┐   │
│  │              │              │        系统管理              │   │
│  │              │  ◄──────────►│  ● 用户管理                  │   │
│  │              │              │  ● 商品管理                  │   │
│  │   管理员      │              │  ● 订单管理                  │   │
│  │              │              │  ● 数据统计                  │   │
│  │              │              │  ● 系统配置                  │   │
│  └──────────────┘              └─────────────────────────────┘   │
│                                                                │
│  ┌──────────────┐              ┌─────────────────────────────┐   │
│  │              │              │        用户功能              │   │
│  │              │  ◄──────────►│  ● 用户注册/登录             │   │
│  │              │              │  ● 浏览商品                  │   │
│  │   普通用户    │              │  ● 搜索商品                  │   │
│  │              │              │  ● 查看详情                  │   │
│  │              │              │  ● 下单购买                  │   │
│  │              │              │  ● AI客服咨询               │   │
│  └──────────────┘              └─────────────────────────────┘   │
│                                                                │
│  ┌──────────────┐              ┌─────────────────────────────┐   │
│  │              │              │        AI客服               │   │
│  │   AI系统      │  ◄──────────►│  ● 智能问答                  │   │
│  │              │              │  ● 商品推荐                  │   │
│  │              │              │  ● 购物指导                  │   │
│  └──────────────┘              └─────────────────────────────┘   │
│                                                                │
└─────────────────────────────────────────────────────────────────┘
```

### 2.2 用户管理用例图

```
用户管理模块
┌─────────────────────────────────────────────────────────────────┐
│                                                                │
│  ┌──────────────┐                                               │
│  │              │           ● 用户注册                           │
│  │              │               │                               │
│  │              │               ▼                               │
│  │   访客        │ ─────────► ● 用户登录                           │
│  │              │               │                               │
│  │              │               ▼                               │
│  └──────────────┘           ● 找回密码                           │
│                                                                │
│  ┌──────────────┐                                               │
│  │              │           ● 查看个人信息                        │
│  │              │               │                               │
│  │              │               ▼                               │
│  │   登录用户    │ ─────────► ● 修改个人信息                        │
│  │              │               │                               │
│  │              │               ▼                               │
│  │              │           ● 修改密码                           │
│  └──────────────┘               │                               │
│                                ▼                               │
│  ┌──────────────┐           ● 查看订单历史                        │
│  │              │               │                               │
│  │              │               ▼                               │
│  │   管理员      │ ─────────► ● 用户权限管理                        │
│  │              │               │                               │
│  │              │               ▼                               │
│  └──────────────┘           ● 用户状态管理                        │
│                                                                │
└─────────────────────────────────────────────────────────────────┘
```

## 三、类图 (Class Diagram)

### 3.1 核心实体类图

```
┌─────────────────────────────────────────────────────────────────┐
│                           User                                 │
├─────────────────────────────────────────────────────────────────┤
│ - id: Long                                                     │
│ - username: String                                             │
│ - password: String                                             │
│ - role: String                                                 │
│ - status: String                                               │
│ - nickname: String                                             │
│ - avatar: String                                               │
│ - mobile: String                                               │
│ - email: String                                                │
│ - createTime: String                                           │
├─────────────────────────────────────────────────────────────────┤
│ + getId(): Long                                                │
│ + setId(id: Long): void                                        │
│ + getUsername(): String                                        │
│ + setUsername(username: String): void                          │
│ + validatePassword(password: String): boolean                  │
│ + isAdmin(): boolean                                           │
└─────────────────────────────────────────────────────────────────┘
                                │
                                │ 1 : N
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                           Order                                │
├─────────────────────────────────────────────────────────────────┤
│ - id: Long                                                     │
│ - orderNumber: String                                          │
│ - count: String                                                │
│ - status: String                                               │
│ - orderTime: String                                            │
│ - payTime: String                                              │
│ - thingId: Long                                                │
│ - userId: Long                                                 │
│ - addressId: Long                                              │
├─────────────────────────────────────────────────────────────────┤
│ + calculateTotal(): BigDecimal                                 │
│ + updateStatus(status: String): void                           │
│ + isPaid(): boolean                                            │
│ + canCancel(): boolean                                         │
└─────────────────────────────────────────────────────────────────┘
                                │
                                │ N : 1
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                           Thing                                │
├─────────────────────────────────────────────────────────────────┤
│ - id: Long                                                     │
│ - title: String                                                │
│ - cover: String                                                │
│ - description: String                                          │
│ - price: String                                                │
│ - status: String                                               │
│ - createTime: String                                           │
│ - pv: String                                                   │
│ - recommendCount: String                                       │
│ - wishCount: String                                            │
│ - collectCount: String                                         │
│ - classificationId: Long                                       │
│ - repertory: String                                            │
├─────────────────────────────────────────────────────────────────┤
│ + isAvailable(): boolean                                       │
│ + updateStock(quantity: int): void                             │
│ + incrementPv(): void                                          │
│ + getFormattedPrice(): String                                  │
└─────────────────────────────────────────────────────────────────┘
                                │
                                │ N : 1
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                      Classification                            │
├─────────────────────────────────────────────────────────────────┤
│ - id: Long                                                     │
│ - title: String                                                │
│ - cover: String                                                │
│ - description: String                                          │
│ - status: String                                               │
│ - createTime: String                                           │
├─────────────────────────────────────────────────────────────────┤
│ + getThingCount(): int                                         │
│ + isActive(): boolean                                          │
└─────────────────────────────────────────────────────────────────┘
```

### 3.2 服务层类图

```
┌─────────────────────────────────────────────────────────────────┐
│                      UserService                               │
├─────────────────────────────────────────────────────────────────┤
│ + login(username: String, password: String): User             │
│ + register(user: User): boolean                                │
│ + updateUserInfo(user: User): boolean                          │
│ + getUserByToken(token: String): User                          │
│ + resetPassword(userId: Long, newPassword: String): boolean    │
│ + getUserList(keyword: String): List<User>                     │
│ + updateUserStatus(userId: Long, status: String): boolean     │
└─────────────────────────────────────────────────────────────────┘
                                │
                                │ implements
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                   UserServiceImpl                              │
├─────────────────────────────────────────────────────────────────┤
│ - userMapper: UserMapper                                       │
│ - passwordEncoder: PasswordEncoder                             │
│ - jwtTokenUtil: JwtTokenUtil                                   │
│ - redisTemplate: RedisTemplate                                 │
├─────────────────────────────────────────────────────────────────┤
│ + login(username: String, password: String): User             │
│ + register(user: User): boolean                                │
│ + updateUserInfo(user: User): boolean                          │
│ + getUserByToken(token: String): User                          │
│ + resetPassword(userId: Long, newPassword: String): boolean    │
│ + getUserList(keyword: String): List<User>                     │
│ + updateUserStatus(userId: Long, status: String): boolean     │
└─────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────┐
│                      ThingService                              │
├─────────────────────────────────────────────────────────────────┤
│ + getThingList(keyword: String, sort: String, c: String,       │
│              tag: String): List<Thing>                         │
│ + getThingById(id: String): Thing                              │
│ + createThing(thing: Thing): boolean                           │
│ + updateThing(thing: Thing): boolean                           │
│ + deleteThing(id: String): boolean                             │
│ + addWishCount(thingId: String): void                          │
│ + addCollectCount(thingId: String): void                       │
└─────────────────────────────────────────────────────────────────┘
                                │
                                │ implements
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                   ThingServiceImpl                             │
├─────────────────────────────────────────────────────────────────┤
│ - thingMapper: ThingMapper                                     │
│ - thingTagMapper: ThingTagMapper                               │
│ - cacheService: CacheService                                   │
├─────────────────────────────────────────────────────────────────┤
│ + getThingList(keyword: String, sort: String, c: String,       │
│              tag: String): List<Thing>                         │
│ + getThingById(id: String): Thing                              │
│ + createThing(thing: Thing): boolean                           │
│ + updateThing(thing: Thing): boolean                           │
│ + deleteThing(id: String): boolean                             │
│ + addWishCount(thingId: String): void                          │
│ + addCollectCount(thingId: String): void                       │
│ - setThingTags(thing: Thing): void                             │
└─────────────────────────────────────────────────────────────────┘
```

## 四、时序图 (Sequence Diagram)

### 4.1 用户登录流程

```
用户    前端页面    UserController    UserService    UserMapper    数据库
│        │            │               │              │           │
│ 输入账密 │            │               │              │           │
├────────►│            │               │              │           │
│        │ 提交登录请求 │               │              │           │
│        ├───────────►│               │              │           │
│        │            │ login()       │              │           │
│        │            ├──────────────►│              │           │
│        │            │               │ 验证用户名密码  │           │
│        │            │               ├─────────────►│           │
│        │            │               │              │ 查询用户   │
│        │            │               │              ├──────────►│
│        │            │               │              │ 返回用户   │
│        │            │               │              │◄──────────┤
│        │            │               │ 返回用户信息   │           │
│        │            │               │◄─────────────┤           │
│        │            │ 生成Token     │              │           │
│        │            │◄──────────────┤              │           │
│        │ 返回Token   │               │              │           │
│        │◄───────────┤               │              │           │
│ 保存Token │            │               │              │           │
│◄────────┤            │               │              │           │
```

### 4.2 商品浏览流程

```
用户    前端页面    ThingController   ThingService   CacheService   ThingMapper   数据库
│        │            │               │              │              │           │
│ 浏览商品 │            │               │              │              │           │
├────────►│            │               │              │              │           │
│        │ 请求商品列表 │               │              │              │           │
│        ├───────────►│               │              │              │           │
│        │            │ getThingList()│              │              │           │
│        │            ├──────────────►│              │              │           │
│        │            │               │ 检查缓存      │              │           │
│        │            │               ├─────────────►│              │           │
│        │            │               │ 缓存命中      │              │           │
│        │            │               │◄─────────────┤              │           │
│        │            │ 返回商品列表   │              │              │           │
│        │            │◄──────────────┤              │              │           │
│        │ 显示商品     │               │              │              │           │
│        │◄───────────┤               │              │              │           │
│        │            │               │              │              │           │
│ 缓存未命中情况：      │               │              │              │           │
│        │            │               │ 查询数据库     │              │           │
│        │            │               ├──────────────────────────────►│           │
│        │            │               │              │              │ 查询数据   │
│        │            │               │              │              ├──────────►│
│        │            │               │              │              │ 返回数据   │
│        │            │               │              │              │◄──────────┤
│        │            │               │ 返回数据      │              │           │
│        │            │               │◄──────────────────────────────┤           │
│        │            │               │ 设置缓存      │              │           │
│        │            │               ├─────────────►│              │           │
│        │            │ 返回商品列表   │              │              │           │
│        │            │◄──────────────┤              │              │           │
│        │ 显示商品     │               │              │              │           │
│        │◄───────────┤               │              │              │           │
```

### 4.3 AI客服对话流程

```
用户    前端页面    AiChatController   AiChatService   外部AI服务   ThingService
│        │            │                │              │           │
│ 发送消息 │            │                │              │           │
├────────►│            │                │              │           │
│        │ 提交聊天请求 │                │              │           │
│        ├───────────►│                │              │           │
│        │            │ chat()         │              │           │
│        │            ├───────────────►│              │           │
│        │            │                │ 构建请求      │           │
│        │            │                │ 调用AI API   │           │
│        │            │                ├─────────────►│           │
│        │            │                │ AI响应       │           │
│        │            │                │◄─────────────┤           │
│        │            │                │ 解析响应      │           │
│        │            │                │ 提取商品推荐   │           │
│        │            │                ├──────────────────────────►│
│        │            │                │ 获取商品详情  │           │
│        │            │                │◄──────────────────────────┤
│        │            │ 返回AI回复     │              │           │
│        │            │◄───────────────┤              │           │
│        │ 显示回复     │                │              │           │
│        │◄───────────┤                │              │           │
```

### 4.4 订单创建流程

```
用户    前端页面    OrderController   OrderService   ThingService   OrderMapper   数据库
│        │            │               │              │              │           │
│ 下单购买 │            │               │              │              │           │
├────────►│            │               │              │              │           │
│        │ 提交订单请求 │               │              │              │           │
│        ├───────────►│               │              │              │           │
│        │            │ createOrder() │              │              │           │
│        │            ├──────────────►│              │              │           │
│        │            │               │ 验证库存      │              │           │
│        │            │               ├─────────────►│              │           │
│        │            │               │ 库存充足      │              │           │
│        │            │               │◄─────────────┤              │           │
│        │            │               │ 生成订单号     │              │           │
│        │            │               │ 创建订单      │              │           │
│        │            │               ├──────────────────────────────►│           │
│        │            │               │              │              │ 插入订单   │
│        │            │               │              │              ├──────────►│
│        │            │               │              │              │ 插入成功   │
│        │            │               │              │              │◄──────────┤
│        │            │               │ 更新库存      │              │           │
│        │            │               ├─────────────►│              │           │
│        │            │               │ 库存更新成功   │              │           │
│        │            │               │◄─────────────┤              │           │
│        │            │ 返回订单信息   │              │              │           │
│        │            │◄──────────────┤              │              │           │
│        │ 显示订单确认 │               │              │              │           │
│        │◄───────────┤               │              │              │           │
```

## 五、状态图 (State Diagram)

### 5.1 订单状态图

```
                    订单状态流转图
┌─────────────────────────────────────────────────────────────────┐
│                                                                │
│   ┌──────────┐    创建订单      ┌──────────┐                     │
│   │  开始     │ ──────────────► │ 待支付    │                     │
│   └──────────┘                 └──────────┘                     │
│                                      │                         │
│                    ┌─────────────────┼─────────────────┐        │
│               支付成功│                               │超时/取消    │
│                    ▼                               ▼        │
│              ┌──────────┐                    ┌──────────┐     │
│              │ 已支付    │                    │ 已取消    │     │
│              └──────────┘                    └──────────┘     │
│                    │                               │        │
│                发货  │                               │        │
│                    ▼                               │        │
│              ┌──────────┐                          │        │
│              │ 已发货    │                          │        │
│              └──────────┘                          │        │
│                    │                               │        │
│                确认收货│                               │        │
│                    ▼                               │        │
│              ┌──────────┐                          │        │
│              │ 已完成    │                          │        │
│              └──────────┘                          │        │
│                    │                               │        │
│                    └───────────────┬───────────────┘        │
│                                    │                        │
│                                    ▼                        │
│                              ┌──────────┐                   │
│                              │   结束    │                   │
│                              └──────────┘                   │
│                                                                │
└─────────────────────────────────────────────────────────────────┘

状态说明：
- 待支付：订单创建，等待用户支付
- 已支付：用户完成支付，等待商家发货
- 已发货：商家已发货，等待用户确认收货
- 已完成：用户确认收货，订单完成
- 已取消：订单被取消（超时或用户主动取消）
```

### 5.2 用户状态图

```
                    用户状态流转图
┌─────────────────────────────────────────────────────────────────┐
│                                                                │
│   ┌──────────┐    注册       ┌──────────┐                       │
│   │  访客     │ ──────────► │ 未激活    │                       │
│   └──────────┘              └──────────┘                       │
│        │                          │                           │
│        │登录失败                    │激活邮箱                     │
│        │                          ▼                           │
│        │                    ┌──────────┐                       │
│        │                    │ 正常用户  │ ◄─────┐                │
│        │                    └──────────┘       │ 解锁           │
│        │                          │           │                │
│        │                    违规操作│           │                │
│        │                          ▼           │                │
│        │                    ┌──────────┐       │                │
│        │                    │ 锁定用户  │ ──────┘                │
│        │                    └──────────┘                       │
│        │                          │                           │
│        │                    严重违规│                           │
│        │                          ▼                           │
│        │                    ┌──────────┐                       │
│        └───────────────────► │ 禁用用户  │                       │
│                              └──────────┘                       │
│                                                                │
└─────────────────────────────────────────────────────────────────┘

状态说明：
- 访客：未注册或未登录的用户
- 未激活：已注册但未激活邮箱的用户
- 正常用户：正常使用系统的用户
- 锁定用户：因违规操作被临时锁定的用户
- 禁用用户：被永久禁用的用户
```

## 六、活动图 (Activity Diagram)

### 6.1 商品购买流程

```
                    商品购买活动图
┌─────────────────────────────────────────────────────────────────┐
│                                                                │
│   ┌──────────┐                                                 │
│   │   开始    │                                                 │
│   └─────┬────┘                                                 │
│         │                                                      │
│         ▼                                                      │
│   ┌──────────┐                                                 │
│   │ 浏览商品  │                                                 │
│   └─────┬────┘                                                 │
│         │                                                      │
│         ▼                                                      │
│   ┌──────────┐                                                 │
│   │ 选择商品  │                                                 │
│   └─────┬────┘                                                 │
│         │                                                      │
│         ▼                                                      │
│   ┌──────────┐    No     ┌──────────┐                          │
│   │用户已登录?│ ─────────► │ 登录/注册 │                          │
│   └─────┬────┘           └─────┬────┘                          │
│     Yes │                      │                              │
│         │ ◄────────────────────┘                              │
│         ▼                                                      │
│   ┌──────────┐                                                 │
│   │ 填写订单  │                                                 │
│   └─────┬────┘                                                 │
│         │                                                      │
│         ▼                                                      │
│   ┌──────────┐    No     ┌──────────┐                          │
│   │ 库存充足? │ ─────────► │ 提示缺货  │                          │
│   └─────┬────┘           └─────┬────┘                          │
│     Yes │                      │                              │
│         │                      ▼                              │
│         │                ┌──────────┐                          │
│         │                │   结束    │                          │
│         │                └──────────┘                          │
│         ▼                                                      │
│   ┌──────────┐                                                 │
│   │ 创建订单  │                                                 │
│   └─────┬────┘                                                 │
│         │                                                      │
│         ▼                                                      │
│   ┌──────────┐                                                 │
│   │ 选择支付  │                                                 │
│   └─────┬────┘                                                 │
│         │                                                      │
│         ▼                                                      │
│   ┌──────────┐    No     ┌──────────┐                          │
│   │ 支付成功? │ ─────────► │ 支付失败  │                          │
│   └─────┬────┘           └─────┬────┘                          │
│     Yes │                      │                              │
│         │                      ▼                              │
│         │                ┌──────────┐                          │
│         │                │   结束    │                          │
│         │                └──────────┘                          │
│         ▼                                                      │
│   ┌──────────┐                                                 │
│   │ 支付成功  │                                                 │
│   └─────┬────┘                                                 │
│         │                                                      │
│         ▼                                                      │
│   ┌──────────┐                                                 │
│   │   结束    │                                                 │
│   └──────────┘                                                 │
│                                                                │
└─────────────────────────────────────────────────────────────────┘
```

### 6.2 AI客服咨询流程

```
                    AI客服咨询活动图
┌─────────────────────────────────────────────────────────────────┐
│                                                                │
│   ┌──────────┐                                                 │
│   │   开始    │                                                 │
│   └─────┬────┘                                                 │
│         │                                                      │
│         ▼                                                      │
│   ┌──────────┐                                                 │
│   │ 用户输入  │                                                 │
│   └─────┬────┘                                                 │
│         │                                                      │
│         ▼                                                      │
│   ┌──────────┐                                                 │
│   │ 发送消息  │                                                 │
│   └─────┬────┘                                                 │
│         │                                                      │
│         ▼                                                      │
│   ┌──────────┐    No     ┌──────────┐                          │
│   │AI服务可用?│ ─────────► │ 返回错误  │                          │
│   └─────┬────┘           └─────┬────┘                          │
│     Yes │                      │                              │
│         │                      ▼                              │
│         │                ┌──────────┐                          │
│         │                │   结束    │                          │
│         │                └──────────┘                          │
│         ▼                                                      │
│   ┌──────────┐                                                 │
│   │ 调用AI API│                                                 │
│   └─────┬────┘                                                 │
│         │                                                      │
│         ▼                                                      │
│   ┌──────────┐                                                 │
│   │ 解析回复  │                                                 │
│   └─────┬────┘                                                 │
│         │                                                      │
│         ▼                                                      │
│   ┌──────────┐    Yes    ┌──────────┐                          │
│   │包含商品推荐?│ ─────────► │ 获取商品  │                          │
│   └─────┬────┘           └─────┬────┘                          │
│      No │                      │                              │
│         │ ◄────────────────────┘                              │
│         ▼                                                      │
│   ┌──────────┐                                                 │
│   │ 返回回复  │                                                 │
│   └─────┬────┘                                                 │
│         │                                                      │
│         ▼                                                      │
│   ┌──────────┐    Yes    ┌──────────┐                          │
│   │继续对话? │ ─────────► │ 用户输入  │ ──┐                     │
│   └─────┬────┘           └──────────┘   │                     │
│      No │                               │                     │
│         │ ◄─────────────────────────────┘                     │
│         ▼                                                      │
│   ┌──────────┐                                                 │
│   │   结束    │                                                 │
│   └──────────┘                                                 │
│                                                                │
└─────────────────────────────────────────────────────────────────┘
```

## 七、组件图 (Component Diagram)

### 7.1 后端组件图

```
┌─────────────────────────────────────────────────────────────────┐
│                        后端系统组件                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                   Controller Layer                     │    │
│  │  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐   │    │
│  │  │UserController│ │ThingController│ │OrderController│   │    │
│  │  └──────────────┘ └──────────────┘ └──────────────┘   │    │
│  │  ┌──────────────┐ ┌──────────────┐                    │    │
│  │  │AiChatController│ │AdminController│                   │    │
│  │  └──────────────┘ └──────────────┘                    │    │
│  └─────────────────────────────────────────────────────────┘    │
│                              │                                 │
│                              ▼                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                    Service Layer                       │    │
│  │  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐   │    │
│  │  │ UserService  │ │ ThingService │ │ OrderService │   │    │
│  │  └──────────────┘ └──────────────┘ └──────────────┘   │    │
│  │  ┌──────────────┐ ┌──────────────┐                    │    │
│  │  │AiChatService │ │ CacheService │                    │    │
│  │  └──────────────┘ └──────────────┘                    │    │
│  └─────────────────────────────────────────────────────────┘    │
│                              │                                 │
│                              ▼                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                   Repository Layer                     │    │
│  │  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐   │    │
│  │  │  UserMapper  │ │ ThingMapper  │ │ OrderMapper  │   │    │
│  │  └──────────────┘ └──────────────┘ └──────────────┘   │    │
│  └─────────────────────────────────────────────────────────┘    │
│                              │                                 │
│                              ▼                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                     Data Layer                         │    │
│  │  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐   │    │
│  │  │    MySQL     │ │    Redis     │ │ File System  │   │    │
│  │  └──────────────┘ └──────────────┘ └──────────────┘   │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                   Common Components                    │    │
│  │  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐   │    │
│  │  │ Interceptor  │ │   Config     │ │    Utils     │   │    │
│  │  └──────────────┘ └──────────────┘ └──────────────┘   │    │
│  │  ┌──────────────┐ ┌──────────────┐                    │    │
│  │  │   Exception  │ │   Security   │                    │    │
│  │  └──────────────┘ └──────────────┘                    │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                │
└─────────────────────────────────────────────────────────────────┘
```

### 7.2 前端组件图

```
┌─────────────────────────────────────────────────────────────────┐
│                        前端系统组件                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                    Page Components                     │    │
│  │  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐   │    │
│  │  │   HomePage   │ │  GoodsPage   │ │  OrderPage   │   │    │
│  │  └──────────────┘ └──────────────┘ └──────────────┘   │    │
│  │  ┌──────────────┐ ┌──────────────┐                    │    │
│  │  │   UserPage   │ │  AdminPage   │                    │    │
│  │  └──────────────┘ └──────────────┘                    │    │
│  └─────────────────────────────────────────────────────────┘    │
│                              │                                 │
│                              ▼                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                 Business Components                    │    │
│  │  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐   │    │
│  │  │  GoodsCard   │ │  GoodsList   │ │ GoodsDetail  │   │    │
│  │  └──────────────┘ └──────────────┘ └──────────────┘   │    │
│  │  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐   │    │
│  │  │  OrderCard   │ │  UserForm    │ │   AiChat     │   │    │
│  │  └──────────────┘ └──────────────┘ └──────────────┘   │    │
│  └─────────────────────────────────────────────────────────┘    │
│                              │                                 │
│                              ▼                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                  Common Components                     │    │
│  │  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐   │    │
│  │  │   Header     │ │   Footer     │ │   Sidebar    │   │    │
│  │  └──────────────┘ └──────────────┘ └──────────────┘   │    │
│  │  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐   │    │
│  │  │   Loading    │ │   Modal      │ │    Toast     │   │    │
│  │  └──────────────┘ └──────────────┘ └──────────────┘   │    │
│  └─────────────────────────────────────────────────────────┘    │
│                              │                                 │
│                              ▼                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                    Utility Layer                       │    │
│  │  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐   │    │
│  │  │   Request    │ │    Router    │ │    Store     │   │    │
│  │  └──────────────┘ └──────────────┘ └──────────────┘   │    │
│  │  ┌──────────────┐ ┌──────────────┐                    │    │
│  │  │    Utils     │ │   Constants  │                    │    │
│  │  └──────────────┘ └──────────────┘                    │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                │
└─────────────────────────────────────────────────────────────────┘
```

## 八、部署图 (Deployment Diagram)

### 8.1 生产环境部署图

```
┌─────────────────────────────────────────────────────────────────┐
│                          生产环境部署                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                │
│  用户设备                                                        │
│  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐              │
│  │   PC浏览器    │ │   手机浏览器   │ │   移动应用    │              │
│  └──────┬───────┘ └──────┬───────┘ └──────┬───────┘              │
│         │                │                │                     │
│         └────────────────┼────────────────┘                     │
│                          │                                      │
│                   Internet                                      │
│                          │                                      │
│  ┌─────────────────────────────────────────────────────────┐     │
│  │                   负载均衡层                            │     │
│  │  ┌──────────────────────────────────────────────────┐  │     │
│  │  │              Nginx 负载均衡器                     │  │     │
│  │  │           (nginx.example.com)                   │  │     │
│  │  └──────────────────────────────────────────────────┘  │     │
│  └─────────────────────────────────────────────────────────┘     │
│                          │                                      │
│         ┌────────────────┼────────────────┐                     │
│         │                │                │                     │
│  ┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐     │
│  │    Web服务器1    │ │    Web服务器2    │ │    Web服务器3    │     │
│  │  ┌─────────────┐ │ │  ┌─────────────┐ │ │  ┌─────────────┐ │     │
│  │  │   Nginx     │ │ │  │   Nginx     │ │ │  │   Nginx     │ │     │
│  │  │  (静态文件)  │ │ │  │  (静态文件)  │ │ │  │  (静态文件)  │ │     │
│  │  └─────────────┘ │ │  └─────────────┘ │ │  └─────────────┘ │     │
│  │  ┌─────────────┐ │ │  ┌─────────────┐ │ │  ┌─────────────┐ │     │
│  │  │SpringBoot应用│ │ │  │SpringBoot应用│ │ │  │SpringBoot应用│ │     │
│  │  │  (端口9100)  │ │ │  │  (端口9100)  │ │ │  │  (端口9100)  │ │     │
│  │  └─────────────┘ │ │  └─────────────┘ │ │  └─────────────┘ │     │
│  └─────────────────┘ └─────────────────┘ └─────────────────┘     │
│                          │                                      │
│                   ┌──────┼──────┐                               │
│                   │             │                               │
│  ┌─────────────────┐    ┌─────────────────┐                     │
│  │   数据库集群     │    │   缓存集群       │                     │
│  │  ┌─────────────┐ │    │  ┌─────────────┐ │                     │
│  │  │MySQL Master │ │    │  │Redis Master │ │                     │
│  │  │(主数据库)    │ │    │  │ (主缓存)    │ │                     │
│  │  └─────────────┘ │    │  └─────────────┘ │                     │
│  │  ┌─────────────┐ │    │  ┌─────────────┐ │                     │
│  │  │MySQL Slave  │ │    │  │Redis Slave  │ │                     │
│  │  │(从数据库)    │ │    │  │ (从缓存)    │ │                     │
│  │  └─────────────┘ │    │  └─────────────┘ │                     │
│  └─────────────────┘    └─────────────────┘                     │
│                                                                │
│  ┌─────────────────────────────────────────────────────────┐     │
│  │                   外部服务                              │     │
│  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐       │     │
│  │  │   AI服务     │ │   支付服务   │ │   文件存储   │       │     │
│  │  │(火山引擎API) │ │ (微信/支付宝) │ │   (OSS)     │       │     │
│  │  └─────────────┘ └─────────────┘ └─────────────┘       │     │
│  └─────────────────────────────────────────────────────────┘     │
│                                                                │
└─────────────────────────────────────────────────────────────────┘
```

### 8.2 开发环境部署图

```
┌─────────────────────────────────────────────────────────────────┐
│                          开发环境部署                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                │
│  开发人员电脑 (localhost)                                        │
│  ┌─────────────────────────────────────────────────────────┐     │
│  │                    开发工具                            │     │
│  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐       │     │
│  │  │IntelliJ IDEA│ │   VSCode    │ │   浏览器     │       │     │
│  │  │ (后端开发)   │ │  (前端开发)  │ │  (测试调试)  │       │     │
│  │  └─────────────┘ └─────────────┘ └─────────────┘       │     │
│  └─────────────────────────────────────────────────────────┘     │
│                                                                │
│  ┌─────────────────────────────────────────────────────────┐     │
│  │                   运行环境                              │     │
│  │  ┌─────────────┐                 ┌─────────────┐       │     │
│  │  │   前端服务   │                 │   后端服务   │       │     │
│  │  │    Vite     │◄────────────────│ SpringBoot  │       │     │
│  │  │ (端口3000)  │   代理转发API     │ (端口9100)  │       │     │
│  │  └─────────────┘                 └─────────────┘       │     │
│  └─────────────────────────────────────────────────────────┘     │
│                          │                                      │
│                          ▼                                      │
│  ┌─────────────────────────────────────────────────────────┐     │
│  │                   本地数据库                            │     │
│  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐       │     │
│  │  │   MySQL     │ │    Redis    │ │  File Dir   │       │     │
│  │  │ (端口3306)  │ │ (端口6379)  │ │ (本地文件夹) │       │     │
│  │  └─────────────┘ └─────────────┘ └─────────────┘       │     │
│  └─────────────────────────────────────────────────────────┘     │
│                                                                │
│  ┌─────────────────────────────────────────────────────────┐     │
│  │                   测试工具                              │     │
│  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐       │     │
│  │  │   Postman   │ │   JUnit     │ │    Jest     │       │     │
│  │  │ (API测试)   │ │ (后端单测)   │ │ (前端单测)   │       │     │
│  │  └─────────────┘ └─────────────┘ └─────────────┘       │     │
│  └─────────────────────────────────────────────────────────┘     │
│                                                                │
└─────────────────────────────────────────────────────────────────┘
```

---

本文档详细描述了智能书城管理系统的架构设计和建模，通过各种UML图表展示了系统的静态结构和动态行为，为系统的开发、部署和维护提供了全面的技术指导。